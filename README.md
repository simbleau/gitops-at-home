<div align="center">

<svg width="144px" height="144px" viewBox="0 0 245 256">
<path d="M96.58,125.53c-5.89,0-10.66,4.78-10.66,10.67c0,5.9,4.77,10.67,10.66,10.67c5.9,0,10.67-4.77,10.67-10.67C107.25,130.31,102.48,125.53,96.58,125.53z M148.56,169.3c-7.35-3.08-15.8,0.38-18.88,7.73c-3.08,7.35,0.38,15.8,7.73,18.88c7.34,3.08,15.8-0.38,18.88-7.73C159.37,180.83,155.91,172.38,148.56,169.3z M148.56,169.3c-7.35-3.08-15.8,0.38-18.88,7.73c-3.08,7.35,0.38,15.8,7.73,18.88c7.34,3.08,15.8-0.38,18.88-7.73C159.37,180.83,155.91,172.38,148.56,169.3z M96.58,125.53c-5.89,0-10.66,4.78-10.66,10.67c0,5.9,4.77,10.67,10.66,10.67c5.9,0,10.67-4.77,10.67-10.67C107.25,130.31,102.48,125.53,96.58,125.53z M190,63.24V7h-31v27.73L122.97,1.82L1.94,110.15l18.4,20.74L39,114.04V254h167V115.08l18.36,16.85l18.89-20.22L190,63.24z M69.55,132.85l7.03-1.19c0.52-2.3,1.43-4.45,2.65-6.39l-4.14-5.81l4.75-4.75l5.81,4.14c1.94-1.23,4.09-2.13,6.39-2.65l1.19-7.03h6.71l1.19,7.03c2.3,0.52,4.45,1.42,6.39,2.65l5.81-4.14l4.75,4.75l-4.14,5.81c1.22,1.94,2.13,4.09,2.65,6.39l7.03,1.19v6.71l-7.03,1.18c-0.52,2.31-1.43,4.46-2.65,6.4l4.14,5.81l-4.75,4.74l-5.81-4.13c-1.94,1.22-4.09,2.13-6.39,2.65l-1.19,7.03h-6.71l-1.19-7.03c-2.3-0.52-4.45-1.43-6.39-2.65l-5.81,4.13l-4.75-4.74l4.14-5.81c-1.22-1.94-2.13-4.09-2.65-6.4l-7.03-1.18V132.85z M102.24,189.33l-4.65,0.78c-0.35,1.53-0.95,2.95-1.76,4.23l2.74,3.85l-3.14,3.14l-3.85-2.74c-1.28,0.81-2.7,1.41-4.23,1.76L86.57,205h-4.44l-0.79-4.65c-1.52-0.35-2.95-0.95-4.23-1.76l-3.84,2.74l-3.14-3.14l2.73-3.85c-0.81-1.28-1.41-2.7-1.75-4.23l-4.66-0.78v-4.44l4.66-0.79c0.34-1.52,0.94-2.95,1.75-4.23l-2.73-3.84l3.14-3.15l3.84,2.74c1.28-0.81,2.71-1.41,4.23-1.75l0.79-4.65h4.44l0.78,4.65c1.53,0.34,2.95,0.94,4.23,1.75l3.85-2.74l3.14,3.15l-2.74,3.84c0.81,1.28,1.41,2.71,1.76,4.23l4.65,0.79V189.33z M170.31,187.4l8.15,5.16l-3.51,8.37l-9.39-2.2c-1.85,2.6-4.11,4.81-6.64,6.59l2.11,9.41l-8.4,3.44l-5.08-8.2c-3.06,0.51-6.22,0.52-9.36-0.04l-5.16,8.15l-8.37-3.51l2.2-9.39c-2.6-1.85-4.81-4.11-6.59-6.64l-9.41,2.12l-3.44-8.4l8.2-5.09c-0.51-3.06-0.52-6.22,0.04-9.36l-8.15-5.16l3.5-8.37l9.4,2.2c1.85-2.6,4.11-4.81,6.64-6.59l-2.12-9.41l8.4-3.44l5.09,8.2c3.06-0.51,6.22-0.51,9.36,0.04l5.16-8.15l8.37,3.51l-2.2,9.39c2.6,1.85,4.81,4.11,6.59,6.64l9.41-2.11l3.44,8.4l-8.2,5.08C170.86,181.1,170.86,184.26,170.31,187.4z M148.56,169.3c-7.35-3.08-15.8,0.38-18.88,7.73c-3.08,7.35,0.38,15.8,7.73,18.88c7.34,3.08,15.8-0.38,18.88-7.73C159.37,180.83,155.91,172.38,148.56,169.3z M96.58,146.87c5.9,0,10.67-4.77,10.67-10.67c0-5.89-4.77-10.67-10.67-10.67c-5.89,0-10.66,4.78-10.66,10.67C85.92,142.1,90.69,146.87,96.58,146.87z M84.35,182.16c-2.73,0-4.95,2.22-4.95,4.95s2.22,4.94,4.95,4.94c2.73,0,4.94-2.21,4.94-4.94S87.08,182.16,84.35,182.16z M96.58,125.53c-5.89,0-10.66,4.78-10.66,10.67c0,5.9,4.77,10.67,10.66,10.67c5.9,0,10.67-4.77,10.67-10.67C107.25,130.31,102.48,125.53,96.58,125.53z M96.58,125.53c-5.89,0-10.66,4.78-10.66,10.67c0,5.9,4.77,10.67,10.66,10.67c5.9,0,10.67-4.77,10.67-10.67C107.25,130.31,102.48,125.53,96.58,125.53z"/>
</svg>

# Home Ops
[![sponsor me](https://img.shields.io/badge/sponsor-30363D?style=for-the-badge&logo=GitHub-Sponsors&logoColor=#white)](https://github.com/sponsors/simbleau)
[![buy me a coffee](https://img.shields.io/badge/Buy_Me_A_Coffee-FFDD00?style=for-the-badge&logo=buy-me-a-coffee&logoColor=black)](https://buymeacoffee.com/simbleau)
[![pre-commit](https://img.shields.io/badge/pre--commit-disabled-red?logo=pre-commit&logoColor=white&style=for-the-badge)](https://github.com/pre-commit/pre-commit)
[![renovate](https://img.shields.io/github/workflow/status/simbleau/home-ops/Schedule%20-%20Renovate?label=renovate&logo=renovatebot&style=for-the-badge)](https://github.com/onedr0p/home-ops/actions/workflows/)

[![internet](https://img.shields.io/uptimerobot/status/m791626909-5410cf23ca18cabcf74e32fa?color=lightgray&label=my%20home%20internet&style=flat-square&logo=opnSense&logoColor=white)](https://uptimerobot.com)
[![website](https://img.shields.io/uptimerobot/status/m791626907-5129386a08c0539012946152?logo=googlechrome&logoColor=white&color=lightgray&label=my%20website&style=flat-square)](https://spencer.imbleau.com)
[![home assistant](https://img.shields.io/uptimerobot/status/m791626943-e78c1a531a0ebfe443491da8?logo=homeassistant&logoColor=white&color=lightgray&label=my%20home%20assistant&style=flat-square)](https://www.home-assistant.io/)

</div>

---

## üìñ Overview
This is a mono repository for my home infrastructure and Kubernetes cluster. I try to adhere to Infrastructure as Code (IaC) and GitOps practices using tools like [__Ansible__](https://www.ansible.com/), [__Terraform__](https://www.terraform.io/), [__Kubernetes__](https://kubernetes.io/), [__Flux__](https://fluxcd.io/), [__Renovate__](https://renovatebot.com/) and [__GitHub Actions__](https://github.com/features/actions). All tools chosen are completely free and at no cost to myself.

---

## üìÅ Directories

- [__`k8s`__](./k8s/): directory contains my Kubernetes configuration and artifacts.
- [__`provision`__](./provision/): directory contains my Ansible playbooks and roles for provisioning my home infrastructure.

---

## ‚õµ Kubernetes
I run a fully conformant Kubernetes cluster at home with K3S, provisioned overtop bare-metal Ubuntu 22.04 using Ansible. This is a semi hyperconverged cluster (HCI), with workloads and block storage sharing the same available resources from a centralized RAID 5 samba share.

üìò _[__Click here__](./k8s/README.md) to learn more about my cluster._

---

## üèÅ Provisioning
Currently, I automate the provisioning of the following systems at home:
- [__My Ubuntu workstation__](./provision/ubuntu-workstation/)
- [__My Kubernetes cluster__](./provision/k8s/)

üìô _[__Click here__](./provision/README.md) to see my Ansible playbooks and roles for provisioning my home infrastructure._

---

## üåê DNS
[![cloudfare](https://img.shields.io/badge/Cloudflare-F38020?style=for-the-badge&logo=Cloudflare&logoColor=white)](https://uptimerobot.com)

Over WAN, I have forwarded ports `80` and `443` from my router. I use [Cloudflare](https://www.cloudflare.com/) as a proxy to hide my home WAN IP and to firewall certain traffic. When not on my home network, all the traffic coming in forwards to my ingress controller on port `80` and `443`. I block all IPs not originating from the [Cloudflares list of IP ranges](https://www.cloudflare.com/ips/).

üìó _[__Click here__](./k8s/README.md) to see how DNS is handled internally and externally by my cluster._

---

## ü§ñ GitOps
- [__Flux__](https://fluxcd.io/) watches my [`cluster`](./k8s/cluster/) folder and makes the changes to my cluster automatically, based on the YAML manifests.
- [__Renovate__](https://renovatebot.com/) watches the repository for dependency updates, and automatically generates PRs for them. Automerging is allowed.
- [__GitHub Actions__](https://github.com/features/actions) validates and tests push and merge requests for conflicts.
- [__GitHub Pages__](https://pages.github.com/) automatic deployment enables my repository to act as a Helm registry.

---

## üîß Hardware
| Device                      | Amt | OS Disk | Data Disk    | RAM   | OS           | Purpose             |
| --------------------------- | --- | ------- | ------------ | ----- | ------------ | ------------------- |
| ARRIS Surfboard SB6183      | 1   | N/A     | N/A          | 256MB | N/A          | Modem               |
| ASUS RT-AC68U               | 1   | N/A     | N/A          | 16GB  | ASUSWRT      | Router, oVPN, SMB   |
| Raspberry Pi 4B 2GB         | 1   | 32GB SD | N/A          | 2GB   | Ubuntu 22.04 | Kubernetes Master   |
| Raspberry Pi 4B 2GB         | 3   | 32GB SD | N/A          | 2GB   | Ubuntu 22.04 | Kubernetes Worker   |
| Raspberry Pi 3 Model B+     | 1   | 32GB SD | N/A          | 1GB   | Ubuntu 22.04 | Kubernetes Worker   |
| AC Infinity CLOUDPLATE T1-N | 1   | N/A     | N/A          | 64GB  | Ubuntu 22.04 | Air Cooling         |
| Kingston SATA 3 2.5" SSD    | 4   | N/A     | 240 GB       | N/A   | N/A          | SATA 3 Internal SSD |
| QNAP TR-004 4 Bay DAS       | 1   | N/A     | 720 GB RAID5 | N/A   | N/A          | RAID 5 DAS          |
| ADJ Products PC-100A PDU    | 1   | N/A     | N/A          | N/A   | N/A          | PDU                 |

---

## üîè License
This project is dual-licensed under both [Apache 2.0](LICENSE-APACHE) and [MIT](LICENSE-MIT) licenses.